# Migration `20201001184802-fix-mode-model`

This migration has been generated by vitor0p9f at 10/1/2020, 3:48:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Info4.id_sensor_unique"

ALTER TABLE "public"."Students" DROP CONSTRAINT "Students_id_usuario_fkey"

ALTER TABLE "public"."Teachers" DROP CONSTRAINT "Teachers_id_usuario_fkey"

ALTER TABLE "public"."Info4" ADD COLUMN "id" SERIAL,
ADD PRIMARY KEY ("id")

ALTER TABLE "public"."Teachers" DROP COLUMN "materias"

ALTER TABLE "public"."Users" ALTER COLUMN "nivel_de_permissao" SET DEFAULT 1

CREATE INDEX "Info4.id_sensor_index" ON "public"."Info4"("id_sensor")

CREATE UNIQUE INDEX "Users.nome_id_usuario_unique" ON "public"."Users"("nome", "id_usuario")

ALTER TABLE "public"."Students" ADD FOREIGN KEY ("id_usuario", "nome")REFERENCES "public"."Users"("id_usuario","nome") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Teachers" ADD FOREIGN KEY ("id_usuario", "nome")REFERENCES "public"."Users"("id_usuario","nome") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200930181503-create-quimica-model..20201001184802-fix-mode-model
--- datamodel.dml
+++ datamodel.dml
@@ -3,12 +3,14 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Info4{
+  id Int @default(autoincrement()) @id
+  mes String
   id_sensor Int 
   total_asor Int 
   asor Int? @default(0)
   total_construcao_de_sites Int
@@ -36,11 +38,10 @@
   total_seguranca_da_informacao Int
   seguranca_da_informacao Int? @default(0)
   total_sociologia Int
   sociologia Int? @default(0)
-  mes String
-  @@unique([id_sensor])
+  @@index([id_sensor])
   Student Students @relation(fields: [id_sensor],references: [id_sensor])
 }
@@ -48,9 +49,9 @@
   id_usuario Int @id @default(autoincrement())
   nome String
   email String @unique
   senha String
-  nivel_de_permissao Int
+  nivel_de_permissao Int @default(1)
   @@unique([nome,id_usuario])
 }
```


