# Migration `20200929111140-create-eletronica-aplicada-model`

This migration has been generated by vitor0p9f at 9/29/2020, 8:11:40 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Students" DROP CONSTRAINT "Students_id_usuario_nome_fkey"

ALTER TABLE "public"."Info4" ALTER COLUMN "mes" SET DATA TYPE text 

CREATE TABLE "public"."Eletronica_aplicada" (
"total_aulas" integer   NOT NULL ,
"aulas_ministradas" integer   NOT NULL ,
"mes" text   NOT NULL ,
"id_modalidade" integer   NOT NULL ,
"id_curso" integer   NOT NULL ,
"id_turma" integer   NOT NULL 
)

CREATE UNIQUE INDEX "Eletronica_aplicada.total_aulas_aulas_ministradas_unique" ON "public"."Eletronica_aplicada"("total_aulas", "aulas_ministradas")

ALTER TABLE "public"."Eletronica_aplicada" ADD FOREIGN KEY ("id_modalidade")REFERENCES "public"."Modes"("id_modalidade") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Eletronica_aplicada" ADD FOREIGN KEY ("id_curso")REFERENCES "public"."Courses"("id_curso") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Eletronica_aplicada" ADD FOREIGN KEY ("id_turma")REFERENCES "public"."Classes"("id_turma") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Students" ADD FOREIGN KEY ("id_usuario", "nome")REFERENCES "public"."Users"("id_usuario","nome") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200929110528-create-shift-model..20200929111140-create-eletronica-aplicada-model
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Info4{
   id_sensor Int 
@@ -36,9 +36,9 @@
   total_seguranca_da_informacao Int
   seguranca_da_informacao Int? @default(0)
   total_sociologia Int
   sociologia Int? @default(0)
-  mes Int
+  mes String
   @@unique([id_sensor])
   Student Students @relation(fields: [id_sensor],references: [id_sensor])
@@ -115,4 +115,18 @@
   id_turno Int @default(autoincrement()) @id
   nome String
 }
+model Eletronica_aplicada{
+  total_aulas Int
+  aulas_ministradas Int
+  mes String
+  id_modalidade Int
+  id_curso Int
+  id_turma Int
+
+  @@unique([total_aulas,aulas_ministradas])
+  
+  Mode Modes @relation(fields: [id_modalidade],references: [id_modalidade])
+  Course Courses @relation(fields: [id_curso],references: [id_curso])
+  Class Classes @relation(fields: [id_turma],references: [id_turma])
+}
```


