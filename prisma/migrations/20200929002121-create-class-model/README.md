# Migration `20200929002121-create-class-model`

This migration has been generated by vitor0p9f at 9/28/2020, 9:21:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Courses" DROP COLUMN "professores",
ADD COLUMN "mattersIdentificador" text   

ALTER TABLE "public"."Matters" DROP COLUMN "id_modalidade",
DROP COLUMN "id_curso",
DROP COLUMN "id_turma",
DROP COLUMN "professores"

ALTER TABLE "public"."Modes" ADD COLUMN "mattersIdentificador" text   

ALTER TABLE "public"."Teachers" ADD COLUMN "coursesId_curso" integer   ,
ADD COLUMN "mattersIdentificador" text   ,
ADD COLUMN "classesId_turma" integer   

CREATE TABLE "public"."Classes" (
"id_turma" SERIAL,
"nome" text   NOT NULL ,
"id_curso" integer   NOT NULL ,
"id_turno" integer   NOT NULL ,
"mattersIdentificador" text   ,
PRIMARY KEY ("id_turma")
)

ALTER TABLE "public"."Classes" ADD FOREIGN KEY ("id_curso")REFERENCES "public"."Courses"("id_curso") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Classes" ADD FOREIGN KEY ("mattersIdentificador")REFERENCES "public"."Matters"("identificador") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Courses" ADD FOREIGN KEY ("id_modalidade")REFERENCES "public"."Modes"("id_modalidade") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Courses" ADD FOREIGN KEY ("mattersIdentificador")REFERENCES "public"."Matters"("identificador") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Modes" ADD FOREIGN KEY ("mattersIdentificador")REFERENCES "public"."Matters"("identificador") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Students" ADD FOREIGN KEY ("id_modalidade")REFERENCES "public"."Modes"("id_modalidade") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Students" ADD FOREIGN KEY ("id_curso")REFERENCES "public"."Courses"("id_curso") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Students" ADD FOREIGN KEY ("id_turma")REFERENCES "public"."Classes"("id_turma") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Teachers" ADD FOREIGN KEY ("coursesId_curso")REFERENCES "public"."Courses"("id_curso") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Teachers" ADD FOREIGN KEY ("mattersIdentificador")REFERENCES "public"."Matters"("identificador") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Teachers" ADD FOREIGN KEY ("classesId_turma")REFERENCES "public"."Classes"("id_turma") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200929000808-create-teacher-model..20200929002121-create-class-model
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Info4{
   id_sensor Int @unique
@@ -59,24 +59,29 @@
   id_curso Int
   id_turma Int
   User Users @relation(fields: [id_usuario],references: [id_usuario])
+  Mode Modes @relation(fields: [id_modalidade],references: [id_modalidade])
+  Course Courses @relation(fields: [id_curso],references: [id_curso])
+  Class Classes @relation(fields: [id_turma],references: [id_turma])
 }
 model Courses{
   id_curso Int @default(autoincrement()) @id
   nome String
-  professores Int[]
+  professores Teachers[]
   id_modalidade Int
+
+  Mode Modes @relation(fields: [id_modalidade],references: [id_modalidade])
 }
 model Matters{
   nome String
   identificador String @unique
-  professores Int[]
-  id_modalidade Int[]
-  id_curso Int[]
-  id_turma Int[]
+  professores Teachers[]
+  id_modalidade Modes[]
+  id_curso Courses[]
+  id_turma Classes[]
 }
 model Modes{
   id_modalidade Int @default(autoincrement()) @id
@@ -90,5 +95,15 @@
   id_sensor_profesor Int @unique
   id_professor Int @default(autoincrement()) @id
   User Users @relation(fields: [id_usuario],references: [id_usuario])
+}
+
+model Classes{
+  id_turma Int @default(autoincrement()) @id
+  nome String
+  professores Teachers[]
+  id_curso Int
+  id_turno Int
+
+  Course Courses @relation(fields: [id_curso],references: [id_curso])
 }
```


